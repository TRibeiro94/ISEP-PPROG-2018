<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pt"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MenuPrestador.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">PPROG_1DE_1181444_1180809_TP3</a> &gt; <a href="index.source.html" class="el_package">UI</a> &gt; <span class="el_source">MenuPrestador.java</span></div><h1>MenuPrestador.java</h1><pre class="source lang-java linenums">package UI;

import static UI.MenuLogin.input;
import Utils.Data;
import Utils.Tempo;
import static Utils.Utilitarios.isNumeric;
import static java.lang.System.exit;
import java.time.YearMonth;
import java.util.Calendar;
import model.AplicacaoGPSD;
import model.Disponibilidade;

/**
 * @author Tiago Ribeiro (1181444)
 * @author Pedro Água (1180809)
 */
public class MenuPrestador {

<span class="nc" id="L19">    public MenuPrestador() {</span>
<span class="nc" id="L20">    }</span>
    
    /**
     * Imprime o menu a ser mostrado apenas a Prestadores de Serviço
     */
    public static void mostrarMenuPrestador() {
<span class="nc" id="L26">        System.out.println();</span>
<span class="nc" id="L27">        System.out.println(&quot;Bem-vindo: &quot; + AplicacaoGPSD.empresa.getDesignacao());</span>
<span class="nc" id="L28">        System.out.println(&quot;----------------------&quot;);</span>
<span class="nc" id="L29">        System.out.println(&quot;MENU PRESTADOR&quot;);</span>
<span class="nc" id="L30">        System.out.println(&quot;----------------------\n&quot;);</span>
<span class="nc" id="L31">        System.out.println(&quot;1- Indicar Disponibilidade diária de prestação de serviço\n&quot;</span>
                         + &quot;0- Sair\n&quot;);
<span class="nc" id="L33">    }</span>
    
    /**
     * Imprime o menu de Prestadores de Serviço enquanto o Prestador não faz uma escolha válida
     * @param loginEmail e-mail do Prestador de Serviço que fez login no sistema
     */
    public void loop(String loginEmail) {
        String escolha;
        do {
<span class="nc" id="L42">            mostrarMenuPrestador();</span>
<span class="nc" id="L43">            escolha = input.nextLine();</span>

<span class="nc bnc" id="L45" title="All 10 branches missed.">            switch (escolha) {</span>
                case &quot;1&quot;:
<span class="nc" id="L47">                    inserirDisponibilidade(loginEmail);</span>
<span class="nc" id="L48">                    break;</span>
                case &quot;0&quot;:
<span class="nc" id="L50">                    exit(0);</span>
                    break;
            }
<span class="nc bnc" id="L53" title="All 4 branches missed.">        } while (escolha != &quot;0&quot; || isNumeric(escolha) == false);</span>
<span class="nc" id="L54">    }</span>
    
    /**
     * Possibilita o prestador inserir a sua Disponibilidade
     * Depois de pedir data e hora, de inicio e fim, solicita a confirmação dos dados.
     * Se confirmar, é instanciada uma Disponibilidade e adicionada à lista das mesmas
     * Se recusar, é mostrado novamente o menu do Prestador de Serviço
     * @param loginEmail e-mail do Prestador de Serviço que fez login no sistema
     */
    public void inserirDisponibilidade(String loginEmail) {
        
<span class="nc" id="L65">        System.out.println(&quot;\nAno de início\n--------------&quot;);</span>
<span class="nc" id="L66">        Data dataInicio = dadosDataInicio();</span>

<span class="nc" id="L68">        System.out.println(&quot;\nAno de Fim\n--------------&quot;);</span>
<span class="nc" id="L69">        Data dataFim = dadosDataFim(dataInicio);</span>

<span class="nc" id="L71">        System.out.println(&quot;\nInsira a hora de início do serviço:&quot;);</span>
<span class="nc" id="L72">        Tempo horaInicio = dadosHoraInicio();</span>

<span class="nc" id="L74">        System.out.println(&quot;\nInsira a hora de fim do serviço:&quot;);</span>
<span class="nc" id="L75">        Tempo horaFim = dadosHoraFim(horaInicio);</span>
        
<span class="nc" id="L77">        System.out.println(&quot;\nConfirme a seguinte Disponibilidade(S/N):\n&quot;);</span>
        
<span class="nc" id="L79">        System.out.println(new Disponibilidade(new Data(dataInicio), new Data(dataFim), new Tempo(horaInicio), new Tempo(horaFim)).toString());</span>
<span class="nc" id="L80">        String confirmacao = input.nextLine();</span>
        
<span class="nc bnc" id="L82" title="All 2 branches missed.">        if(confirmacao.equalsIgnoreCase(&quot;s&quot;)){</span>
            
<span class="nc" id="L84">            AplicacaoGPSD.empresa.getPrestadorByEmail(loginEmail).adicionarDisponibilidade(new Disponibilidade(new Data(dataInicio), new Data(dataFim), new Tempo(horaInicio), new Tempo(horaFim)));</span>
            
<span class="nc bnc" id="L86" title="All 2 branches missed.">        }else if(confirmacao.equalsIgnoreCase(&quot;n&quot;)){</span>
            
<span class="nc" id="L88">            loop(loginEmail);</span>
            
        }else{
            
<span class="nc" id="L92">            System.out.println(&quot;\nInseriu uma resposta inválida. Insira a sua disponibilidade de novo e confirme se forma válida.&quot;);</span>
<span class="nc" id="L93">            MenuPrestador m = new MenuPrestador();</span>
<span class="nc" id="L94">            m.loop(loginEmail);</span>
        }
<span class="nc" id="L96">    }</span>
    
    /**
     * Possibilita o Prestador de inserir a data de inicio da sua Disponibilidade
     * ano , mes, dia
     * @return Data de inicio da disponibilidade
     */
    public Data dadosDataInicio() {

<span class="nc" id="L105">        Calendar calendario = Calendar.getInstance();</span>

<span class="nc" id="L107">        input.nextLine();</span>
<span class="nc" id="L108">        System.out.println(&quot;Ano:&quot;);</span>
<span class="nc" id="L109">        String ano = input.nextLine();</span>

<span class="nc bnc" id="L111" title="All 4 branches missed.">        while (isNumeric(ano) == false || (Integer.parseInt(ano) &lt; calendario.get(Calendar.YEAR))) {</span>
<span class="nc" id="L112">            System.out.println(&quot;Ano inválido. Tente de novo:&quot;);</span>
<span class="nc" id="L113">            ano = input.nextLine();</span>
        }
<span class="nc" id="L115">        int anoInicio = Integer.parseInt(ano);</span>

<span class="nc" id="L117">        System.out.println(&quot;Mês:&quot;);</span>
<span class="nc" id="L118">        String mes = input.nextLine();</span>

<span class="nc bnc" id="L120" title="All 10 branches missed.">        while (isNumeric(mes) == false || (anoInicio == calendario.get(Calendar.YEAR) &amp;&amp; (Integer.parseInt(mes) &lt; (calendario.get(Calendar.MONTH) + 1))) || (Integer.parseInt(mes) &gt; 12) || (Integer.parseInt(mes) &lt;= 0)) {</span>
<span class="nc" id="L121">            System.out.println(&quot;Mês inválido. Tente de novo:&quot;);</span>
<span class="nc" id="L122">            mes = input.nextLine();</span>
        }
<span class="nc" id="L124">        int mesInicio = Integer.parseInt(mes);</span>
        
<span class="nc" id="L126">        YearMonth anoMes = YearMonth.of(anoInicio, mesInicio);</span>
<span class="nc" id="L127">        int diasMes = anoMes.lengthOfMonth();</span>

<span class="nc" id="L129">        System.out.println(&quot;Dia:&quot;);</span>
<span class="nc" id="L130">        String dia = input.nextLine();</span>

<span class="nc bnc" id="L132" title="All 12 branches missed.">        while (isNumeric(dia) == false || (Integer.parseInt(dia) &gt; diasMes) || (anoInicio == calendario.get(Calendar.YEAR) &amp;&amp; mesInicio == (calendario.get(Calendar.MONTH) + 1) &amp;&amp; (Integer.parseInt(dia) &lt; calendario.get(Calendar.DAY_OF_MONTH))) || (Integer.parseInt(dia) &lt;= 0)) {</span>
<span class="nc" id="L133">            System.out.println(&quot;Dia inválido. Tente de novo:&quot;);</span>
<span class="nc" id="L134">            dia = input.nextLine();</span>
        }
<span class="nc" id="L136">        int diaInicio = Integer.parseInt(dia);</span>

<span class="nc" id="L138">        return new Data(anoInicio, mesInicio, diaInicio);</span>
    }
    
    /**
     * Possibilita o Prestador de inserir a data de fim da sua Disponibilidade
     * @param dataInicio Data de inicio que foi introduzida previamente
     * @return Data de fim de Disponibilidade
     */
    public Data dadosDataFim(Data dataInicio) {

<span class="nc" id="L148">        System.out.println(&quot;Ano:&quot;);</span>
<span class="nc" id="L149">        String ano = input.nextLine();</span>

<span class="nc bnc" id="L151" title="All 4 branches missed.">        while (isNumeric(ano) == false || (Integer.parseInt(ano) &lt; dataInicio.getAno())) {</span>
<span class="nc" id="L152">            System.out.println(&quot;Ano inválido. Tente de novo:&quot;);</span>
<span class="nc" id="L153">            ano = input.nextLine();</span>
        }
<span class="nc" id="L155">        int anoFim = Integer.parseInt(ano);</span>

<span class="nc" id="L157">        System.out.println(&quot;Mês:&quot;);</span>
<span class="nc" id="L158">        String mes = input.nextLine();</span>

<span class="nc bnc" id="L160" title="All 10 branches missed.">        while (isNumeric(mes) == false || (anoFim == dataInicio.getAno() &amp;&amp; Integer.parseInt(mes) &lt; dataInicio.getMes()) || (Integer.parseInt(mes) &gt; 12) || (Integer.parseInt(mes) &lt;= 0)) {</span>
<span class="nc" id="L161">            System.out.println(&quot;Mês inválido. Tente de novo:&quot;);</span>
<span class="nc" id="L162">            mes = input.nextLine();</span>
        }
<span class="nc" id="L164">        int mesFim = Integer.parseInt(mes);</span>
        
<span class="nc" id="L166">        YearMonth anoMes = YearMonth.of(anoFim, mesFim);</span>
<span class="nc" id="L167">        int diasMes = anoMes.lengthOfMonth();</span>

<span class="nc" id="L169">        System.out.println(&quot;Dia:&quot;);</span>
<span class="nc" id="L170">        String dia = input.nextLine();</span>

<span class="nc bnc" id="L172" title="All 10 branches missed.">        while (isNumeric(dia) == false || (Integer.parseInt(dia) &gt; diasMes) || (anoFim == dataInicio.getAno() &amp;&amp; mesFim == dataInicio.getMes() &amp;&amp; (Integer.parseInt(dia) &lt; dataInicio.getDia()))) {</span>
<span class="nc" id="L173">            System.out.println(&quot;Dia inválido. Tente de novo:&quot;);</span>
<span class="nc" id="L174">            dia = input.nextLine();</span>
        }
<span class="nc" id="L176">        int diaFim = Integer.parseInt(dia);</span>

<span class="nc" id="L178">        return new Data(anoFim, mesFim, diaFim);</span>
    }
    
    /**
     * Possibilita o Prestador de inserir a hora de inicio da sua Disponibilidade
     * @return Hora inicio da disponibilidade
     */
    public Tempo dadosHoraInicio() {

<span class="nc" id="L187">        String inicio = input.nextLine();</span>
<span class="nc bnc" id="L188" title="All 6 branches missed.">        while (isNumeric(inicio) == false || Integer.parseInt(inicio) &gt; 24 || Integer.parseInt(inicio) &lt;= 0) {</span>
<span class="nc" id="L189">            System.out.println(&quot;Hora inválida. Tente de novo(formato 24h):&quot;);</span>
<span class="nc" id="L190">            inicio = input.nextLine();</span>
        }
<span class="nc" id="L192">        int horaInicio = Integer.parseInt(inicio);</span>

<span class="nc" id="L194">        return new Tempo(horaInicio);</span>
    }
    
    /**
     * Possibilita o Prestador de inserir a hora de fim da sua Disponibilidade
     * @param horaInicio hora de inicio que foi introduzida previamente
     * @return hora de fim da disponibilidade
     */
    public Tempo dadosHoraFim(Tempo horaInicio) {
        
<span class="nc" id="L204">        String fim = input.nextLine();</span>
        
<span class="nc bnc" id="L206" title="All 8 branches missed.">        while (isNumeric(fim) == false || Integer.parseInt(fim) &gt; 24 || (Integer.parseInt(fim) &lt;= 0) || Integer.parseInt(fim) &lt;= horaInicio.getHoras()) {</span>
<span class="nc" id="L207">            System.out.println(&quot;Hora inválida. Tente de novo:&quot;);</span>
<span class="nc" id="L208">            fim = input.nextLine();</span>
        }
<span class="nc" id="L210">        int horaFim = Integer.parseInt(fim);</span>

<span class="nc" id="L212">        return new Tempo(horaFim);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>